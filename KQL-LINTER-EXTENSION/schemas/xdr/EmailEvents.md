# EmailEvents

**Category:** Email & Collaboration  
**Description:** Microsoft 365 email events, including email delivery and blocking events

## Schema

| Column | Type | Description |
|--------|------|-------------|
| Timestamp | datetime | Date and time when the event was recorded |
| MessageId | string | Unique identifier for the email |
| NetworkMessageId | string | Unique identifier for the email generated by Microsoft 365 |
| InternetMessageId | string | Public-facing identifier for the email set by the sending email system |
| SenderMailFromAddress | string | Sender email address in the MAIL FROM header, also known as the envelope sender or the Return-Path address |
| SenderFromAddress | string | Sender email address in the FROM header, which is visible to email recipients on their email clients |
| SenderDisplayName | string | Name of the sender displayed in the address book, typically a combination of a given or first name, a middle initial, and a last name or surname |
| SenderObjectId | string | Unique identifier for the sender's account in Azure AD |
| SenderMailFromDomain | string | Sender domain in the MAIL FROM header, also known as the envelope sender or the Return-Path address |
| SenderFromDomain | string | Sender domain in the FROM header, which is visible to email recipients on their email clients |
| SenderIPv4 | string | IPv4 address of the last detected mail server that relayed the message |
| SenderIPv6 | string | IPv6 address of the last detected mail server that relayed the message |
| RecipientEmailAddress | string | Email address of the recipient, or email address of the recipient after distribution list expansion |
| RecipientObjectId | string | Unique identifier for the email recipient in Azure AD |
| Subject | string | Subject of the email |
| EmailClusterId | string | Identifier for the group of similar emails clustered based on heuristic analysis of their contents |
| EmailDirection | string | Direction of the email relative to your network: Inbound, Outbound, Intra-org |
| DeliveryAction | string | Delivery action of the email: Delivered, Junked, Blocked, or Replaced |
| DeliveryLocation | string | Location where the email was delivered: Inbox/Folder, Junk, Deleted, Quarantine, External, Failed, Dropped, Forwarded |
| ThreatTypes | string | Verdict from the email filtering stack on whether the email contains malware, phishing, or other threats |
| ThreatNames | string | Detection name for malware or other threats found |
| DetectionMethods | string | Methods used to detect malware, phishing, or other threats found in the email |
| ConfidenceLevel | string | List of confidence levels of any spam or phishing verdicts. For spam, this column shows the spam confidence level (SCL), indicating if the email was skipped (-1), found to be not spam (0,1), found to be spam with moderate confidence (5,6), or found to be spam with high confidence (9). For phishing, this column displays whether the confidence level is "High" or "Low". |
| EmailAction | string | Final action taken on the email based on filter verdict, policies, and user actions: Move to junk, Add X-header, Modify subject, Redirect, Delete, send to quarantine, No action taken, Bcc message |
| EmailActionPolicy | string | Action policy that took effect: Anti-spam high-confidence, Anti-spam, Anti-malware, Safe attachments, Anti-phish, Anti-phish domain impersonation, Anti-phish user impersonation, Anti-phish spoof, Anti-phish graph, Anti-malware campaign, Mixed analysis detection, Domain reputation |
| EmailActionPolicyGuid | string | Unique identifier for the policy that determined the final mail action |
| AttachmentCount | int | Number of attachments in the email |
| UrlCount | int | Number of URLs in the email |
| EmailLanguage | string | Detected language of the email content |
| Connectors | string | Custom instructions that define organizational mail flow and how the email was routed |
| OrgLevelAction | string | Action taken on the email in response to matches to a policy defined at the organizational level |
| OrgLevelPolicy | string | Organizational policy that triggered the action taken on the email |
| UserLevelAction | string | Action taken on the email in response to matches to a mailbox policy defined by the recipient |
| UserLevelPolicy | string | End-user mailbox policy that triggered the action taken on the email |
| ReportId | long | Event identifier based on a repeating counter |
| AdditionalFields | string | Additional information about the event in JSON array format |

## Common ThreatTypes Values

- **Phish** - Phishing email
- **Malware** - Contains malware
- **Spam** - Spam email
- **Bulk** - Bulk email

## Common DeliveryAction Values

- **Delivered** - Email was delivered successfully
- **Blocked** - Email was blocked
- **Junked** - Email was moved to junk folder
- **Replaced** - Email was replaced (e.g., attachments removed)

## Common Query Patterns

```kql
// Hunt for phishing emails
EmailEvents
| where ThreatTypes has "Phish"
| where DeliveryAction == "Delivered"
| project Timestamp, SenderFromAddress, RecipientEmailAddress, Subject

// Monitor for suspicious attachment patterns
EmailEvents
| where AttachmentCount > 0
| where ThreatTypes has_any ("Malware", "Phish")
| summarize Count = count() by SenderFromDomain, ThreatTypes
```
